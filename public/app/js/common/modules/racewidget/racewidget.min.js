var configData={GENERAL_CONFIG:{APP_NAME:"raceWiget",APP_VERSION:"0.0.1",BUTTON_LINK:"http://www.racebets.com/bet/",CURRENCIES:{GBP:1,EUR:.77}}},racewidget=angular.module("racewidget",[]);angular.forEach(configData,function(e,r){racewidget.constant(r,e)}),racewidget.run(["$rootScope","$http",function(e,r){r.get("/next_races.json").success(function(r){e.serverData=r,e.$broadcast("json-ready")}).error(function(e,r){console.info(e),console.info(r)})}]),racewidget.directive("racewidget",["$rootScope","GENERAL_CONFIG",function(e,r){return{scope:{filterResults:"="},template:"<div class=raceWiget ng-repeat=\"race in races|types:filterResults |convertCurrencyes:currencyes| orderBy:'-purse.ourAmount'|limitTo:'1'\"><header><i><img ng-src=i/flags/{{race.event.country.toLowerCase()}}.png></i> <a ng-href={{buttonLink}}{{race.id_race}} class=headName>{{race.event.title}}</a><time>6min</time><div class=info><a ng-href={{buttonLink}}{{race.id_race}}>{{race.num_runners}} runners</a> <a ng-href={{buttonLink}}{{race.id_race}}>{{race.distance}} m</a> <a ng-href={{buttonLink}}{{race.id_race}}>{{race.purse.amount}} {{race.purse.currency}}</a> <i><img src=i/flags/ai.png></i></div></header><ul class=items><li ng-repeat=\"runner in race.runners\"><i ng-if=runner.silk><img ng-src=i/silks/{{runner.silk}}></i> <a ng-href={{buttonLink}}{{race.id_race}} class=name>{{runner.name}}</a> <a ng-href={{buttonLink}}{{race.id_race}} class=coeff>{{runner.odds}}</a></li></ul></div>",link:function(n,t,a){n.buttonLink=r.BUTTON_LINK,n.currencyes=r.CURRENCIES,n.$on("json-ready",function(r,t){n.races=e.serverData.data.races,n.btns=n.filterButtons})}}}]),racewidget.filter("types",function(){return function(e,r){var n=[];return e&&r&&e.map(function(e){r.map(function(r){r.active&&r.type==e.race_type&&n.push(e)})}),n}}),racewidget.filter("convertCurrencyes",function(){return function(e,r){return e&&r&&e.map(function(e){var n=r[e.purse.currency];e.purse.ourAmount=e.purse.amount*n}),e}});